KONTROLAKARAOGLAN:
LOAD
BELNR AS BELGE_NO,
BUKRS AS SIRKET_KODU,
GJAHR AS YIL,
BLDAT as BELGE_TARIHI,
BUDAT AS KAYITTARIH,

//Date(BLDAT, 'DD.MM.YYYY') AS BELGE_TARIHI,
//Date(BUDAT, 'DD.MM.YYYY') AS KAYITTARIH,
BLART AS BELGE_TURU,
USNAM AS OLUSTURAN_KULLANICI,
TCODE AS TRANSAKSIYON_KODU,
AEDAT AS DEGISIKLIK_TARIHI,
XBLNR AS REFERANS,
AWREF_REV AS TERSBELGENO;

SQL SELECT
    BELNR,
    BUKRS,
    GJAHR,
    BLDAT,
    BUDAT,
    BLART,
    USNAM,
    TCODE,
    AEDAT,
    XBLNR,
    AWREF_REV
FROM BKPF
WHERE USNAM IN (
    'AKARAOGLAN', 'NZAMBAK', 'KCELEBI', 'MSERDAR',
    'SPERKKARA', 'MGUL', 'ISOZER', 'GATILGAN',
    'IBABA', 'HANDAN', 'CERDOGAN', 'SCELIK', 'NDEMIREL', 'SEMRE', 'ASEVINC', 'FALTINDAG', 'AKABADAYI', 'FGULGAR', 'MYAMAN', 'AYASAR'
)
AND BUKRS = '2000'
AND BLDAT BETWEEN '20250101' AND '20251231'
AND BLART IN ('Y1', 'RE', 'KR')
AND (AWREF_REV IS NULL OR AWREF_REV = '');

// --- BSEG'den sadece tedarikçi satırlarını al, sonra tekilleştir ---
BSEG_VendorRaw:
SQL SELECT
  BELNR, GJAHR, BUKRS, LIFNR, KOART, BSCHL
FROM BSEG
WHERE GJAHR = '2025'
  AND BUKRS = '2000'
  AND KOART = 'K';     // Yalnızca tedarikçi satırları

// Aynı BELNR/BUKRS/GJAHR için birden fazla LIFNR varsa tek satıra indir
BSEG_VendorAgg:
LOAD
  BELNR,
  GJAHR,
  BUKRS,
  MaxString(LIFNR) AS LIFNR   // veya FirstSortedValue(LIFNR, -BSCHL) gibi bir kural da kullanabilirsin
RESIDENT BSEG_VendorRaw
GROUP BY BELNR, GJAHR, BUKRS;

// Artık çoğalma olmadan join
LEFT JOIN (KONTROLAKARAOGLAN)
LOAD
  BELNR AS BELGE_NO,
  GJAHR AS YIL,
  BUKRS AS SIRKET_KODU,
  LIFNR AS SATICINO
RESIDENT BSEG_VendorAgg;

DROP TABLE BSEG_VendorRaw;
DROP TABLE BSEG_VendorAgg;

LEFT JOIN(KONTROLAKARAOGLAN)
LOAD
LIFNR AS SATICINO,
NAME1 & NAME2 AS CARIADI;
SQL SELECT LIFNR, NAME1, NAME2 FROM LFA1;



